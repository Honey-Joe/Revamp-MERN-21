<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Form</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <!--FireBase SDK-->
    <script
      defer
      src="https://www.gstatic.com/firebasejs/8.10.1/firebase.js"
    ></script>
    <script
      defer
      src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"
    ></script>
    <script
      defer
      src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"
    ></script>
  </head>
  <body>
    <div class="2xl:container mx-auto">
      <div class="w-[90%] mx-auto flex justify-center items-center h-screen">
        <div
          class="flex flex-col gap-5 shadow-lg rounded-lg border p-5 max-w-[400px] w-[100%]"
        >
          <h1 class="text-center font-bold text-[28px]">Login</h1>
          <form class="flex flex-col gap-5" id="form">
            <div class="flex flex-col gap-3">
              <label for="email">Email:</label>
              <input
                type="text"
                name="email"
                id="email"
                class="py-2 pl-2 rounded-lg border-2 outline-none"
                placeholder="Enter you email..."
              />
              <p class="text-red-600 text-sm" id="emailError"></p>
            </div>

            <div class="flex flex-col gap-3">
              <label for="password">Password:</label>
              <input
                type="text"
                name="password"
                id="password"
                class="py-2 pl-2 rounded-lg border-2 outline-none"
                placeholder="Enter you password..."
              />
              <p class="text-red-600 text-sm" id="passError"></p>
            </div>

            <button
              class="py-2 rounded-lg border border-green-600 bg-green-600 text-white hover:border hover:border-green-600 hover:text-green-600 transition-all hover:bg-white w-full"
            >
              Login
            </button>
          </form>
        </div>
      </div>
    </div>

    <script>
      var form = document.getElementById("form");
      var email = document.getElementById("email");
      var password = document.getElementById("password");
      var emailError = document.getElementById("emailError");
      var passError = document.getElementById("passError");

      form.addEventListener("submit", (e) => {
        e.preventDefault();
        const valid = advancedValidation(email.value, password.value);

        if (valid) {
          saveData(email.value, password.value);
        }
      });

      const saveData = (email, pass) => {
        // Your web app's Firebase configuration
        const firebaseConfig = {
          apiKey: "AIzaSyBiyaL7z0JTojMLRocgCKAX-2h72wEraLs",
          authDomain: "merndb-21.firebaseapp.com",
          databaseURL:
            "https://merndb-21-default-rtdb.asia-southeast1.firebasedatabase.app",
          projectId: "merndb-21",
          storageBucket: "merndb-21.firebasestorage.app",
          messagingSenderId: "248364824831",
          appId: "1:248364824831:web:ed1aa6e72ad63e688874ca",
        };

        firebase.initializeApp(firebaseConfig);

        const db = firebase.database().ref("login");

        db.push({
          email: email,
          password: pass,
        });

        console.log("Data send");
      };

      email.addEventListener("input", (e) => {
        const emailRegex = /^\S+@\S+\.\S+$/;

        if (e.target.value == "") {
          emailError.textContent = "Required";
        } else if (e.target.value.match(emailRegex)) {
          emailError.textContent = "";
        } else {
          emailError.textContent = "Invalid email format";
        }
      });

      password.addEventListener("input", (e) => {
        const charRegex = /(?=.*?[#?!@$%^&*-])/;
        const passRegex =
          /^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$/;

        if (e.target.value == "") {
          passError.textContent = "Required";
        } else if (!e.target.value.match(charRegex)) {
          passError.textContent = "Atleast one spl char..";
        } else if (e.target.value.match(passRegex)) {
          passError.textContent = "";
        } else {
          passError.textContent = "Invalid pass format Coding@123";
        }
      });

      const advancedValidation = (email, password) => {
        const emailRegex = /^\S+@\S+\.\S+$/; // email formet
        const passRegex =
          /^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$/; // pass formet

        let isValid = true;

        if (email.match(emailRegex)) {
          console.log(email);
          emailError.textContent = "";
        } else {
          emailError.textContent = "Invalid email formet";
          isValid = false;
        }

        if (password.match(passRegex)) {
          passError.textContent = "";
          console.log(password);
        } else {
          passError.textContent = "Invalid password formet";
          isValid = false;
        }

        return isValid;
      };
    </script>
  </body>
</html>
